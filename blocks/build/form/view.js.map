{"version":3,"file":"form/view.js","mappings":"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","sources":["webpack://hizzle-forms/./blocks/src/form/view.scss","webpack://hizzle-forms/external window [\"wp\",\"apiFetch\"]","webpack://hizzle-forms/external window [\"wp\",\"domReady\"]","webpack://hizzle-forms/external window [\"wp\",\"i18n\"]","webpack://hizzle-forms/webpack/bootstrap","webpack://hizzle-forms/webpack/runtime/compat get default export","webpack://hizzle-forms/webpack/runtime/define property getters","webpack://hizzle-forms/webpack/runtime/hasOwnProperty shorthand","webpack://hizzle-forms/webpack/runtime/make namespace object","webpack://hizzle-forms/./blocks/src/form/view.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"domReady\"];","module.exports = window[\"wp\"][\"i18n\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Internal dependencies\n */\nimport './view.scss';\nimport apiFetch from '@wordpress/api-fetch';\nimport { __ } from '@wordpress/i18n';\nimport domReady from '@wordpress/dom-ready';\n\n/**\n * Converts a key to a value or object.\n *\n * key[]=value becomes { key: [ value ] }\n * key[key2]=value becomes { key: { key2: value } }\n * key[key2][key3]=value becomes { key: { key2: { key3: value } } }\n * key[][key3]=value becomes { key: [ { key3: value } ] }\n * key=value becomes { key: value }\n *\n * @param {string} key\n * @param {string} value\n * @param {Object} obj\n * @return {Object}\n */\nconst keyToValue = (key, value, obj) => {\n\n\tif ( '' === key ) {\n\t\treturn value;\n\t}\n\n\t// Split the key into parts.\n\tconst parts = key.split('[');\n\n\t// If there are no parts, return the value.\n\tif (parts.length === 1) {\n\t\treturn { ...obj, [key]: value };\n\t}\n\n\t// If only one part remains, return the value.\n\tif (parts.length === 2) {\n\t\tconst [first, second] = parts;\n\n\t\tconst innerKey = second.slice(0, -1);\n\n\t\t// If '' === innerKey, it's an array.\n\t\tif (innerKey === '') {\n\t\t\tconst previous = obj[first] || [];\n\t\t\tprevious.push(value);\n\n\t\t\treturn { ...obj, [first]: previous };\n\t\t}\n\n\t\t// Otherwise, it's an object.\n\t\tconst previous = obj[first] || {};\n\t\treturn { ...obj, [first]: { ...previous, [innerKey]: value } };\n\t}\n\n\t// Otherwise, this is a nested object, e.g  key[key2][key3]=value or key[][key3]=value.\n\tconst [first, ...rest] = parts;\n\tlet innerKey = rest.join('['); // Either key2][key3]=value or ][key3]=value.\n\n\t// Process nested object, e.g key2][key3]=value.\n\tif ( ! innerKey.startsWith(']') ) {\n\t\tconst previous = obj[first] || {};\n\t\treturn { ...obj, [first]: keyToValue( innerKey.replace(/\\]/, ''), value, previous) };\n\t}\n\n\t// Process nested array, e.g. ][key3]=value.\n\tconst previous = obj[first] || [];\n\n\t// Unwrap second key.\n\tprevious.push( keyToValue( innerKey.slice(1).replace(/\\[/, '').replace(/\\]/, ''), value, {} ) );\n\n\treturn { ...obj, [first]: previous };\n};\n\n/**\n * \n * @param {FormData} formData \n * @returns {Object}\n */\nconst formDataToObject = (formData ) => {\n\tlet data = {};\n\n\t// Convert the form data to an object.\n\tformData.forEach((value, key) => {\n\t\tdata = keyToValue(key, value, data);\n\t});\n\n\treturn data;\n};\n\ndomReady(() => {\n\n\t// Watch for form submissions.\n\tdocument.addEventListener('submit', (e) => {\n\n\t\t// Our forms have the .wp-block-hizzle-forms-form class.\n\t\tif (!e.target.classList.contains('wp-block-hizzle-forms-form')) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Prevent the form from submitting.\n\t\te.preventDefault();\n\n\t\t// Get the form.\n\t\tconst form = e.target;\n\n\t\t// Get the form ID from data-instance-id attribute.\n\t\tconst formID = form.dataset.instanceId;\n\n\t\t// Get the form fields.\n\t\tconst fields = new FormData(form);\n\n\t\t// Add the conversion page to the form fields.\n\t\tfields.append('hizzle_conversion_page', window.location.href);\n\n\t\tconsole.log(formDataToObject(fields));\n\t\t// Add submitting class to the form.\n\t\tform.classList.add('hizzle-forms-submitting');\n\n\t\t// Post the form.\n\t\tapiFetch({\n\t\t\tpath: '/hizzle/v1/forms/submit/' + formID,\n\t\t\tmethod: 'POST',\n\t\t\tdata: formDataToObject(fields),\n\t\t}).then((res) => {\n\n\t\t\tif ('message' === res.action) {\n\t\t\t\t// TODO:\n\t\t\t}\n\n\t\t\tif ('redirect' === res.action) {\n\t\t\t\t// TODO:\n\t\t\t}\n\n\t\t\treturn res;\n\t\t}).catch((err) => {\n\t\t\tconsole.log(err);\n\t\t}).finally(() => {\n\t\t\t// Remove submitting class from the form.\n\t\t\tform.classList.remove('hizzle-forms-submitting');\n\t\t});\n\n\t});\n});\n"],"names":["apiFetch","__","domReady","keyToValue","key","value","obj","parts","split","length","first","second","innerKey","slice","previous","push","rest","join","startsWith","replace","formDataToObject","formData","data","forEach","document","addEventListener","e","target","classList","contains","preventDefault","form","formID","dataset","instanceId","fields","FormData","append","window","location","href","console","log","add","path","method","then","res","action","catch","err","finally","remove"],"sourceRoot":""}